const RENDER_BASE = "https://your-app.onrender.com"; // غيّر بالرابط تبع Render

document.getElementById('searchForm').addEventListener('submit', function(e) {
    e.preventDefault();
    const keyword = document.getElementById('keywordInput').value.trim();
    if (!keyword) { alert('أدخل كلمة مفتاحية'); return; }

    document.getElementById('loader').classList.add('active');

    fetch(`${RENDER_BASE}/api/analyze`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ keyword })
    })
    .then(res => res.json())
    .then(data => {
        document.getElementById('loader').classList.remove('active');
        if (data.error) { alert(data.error); return; }

        // عرض النتائج
        const resultsGrid = document.getElementById('resultsGrid');
        resultsGrid.innerHTML = `
            <div class="result-card"><h3>🔗 العنوان</h3><div>${data.suggested_title}</div></div>
            <div class="result-card"><h3>📝 الوصف</h3><div>${data.meta_description}</div></div>
            <div class="result-card"><h3>📌 المقتطف</h3><div>${data.snippet_text}</div></div>
            <div class="result-card"><h3>🏷️ الكلمات المفتاحية</h3><div>${data.nlp_keywords}</div></div>
            <div class="result-card"><h3>📑 مخطط المقال</h3><div>${data.outline.map(o => `<p>${o.text}</p>`).join('')}</div></div>
            <div class="result-card"><h3>🌍 الروابط</h3><div>${data.featured_snippets.map(l => `<a href="https://${l}" target="_blank">${l}</a>`).join('<br>')}</div></div>
        `;
        document.getElementById('results').classList.add('active');
    })
    .catch(err => {
        document.getElementById('loader').classList.remove('active');
        alert("فشل الاتصال: " + err);
    });
});
